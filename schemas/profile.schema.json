{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://shield-artillery/profile.schema.json",
  "title": "User Profile Configuration",
  "description": "Defines user profiles with weighted distribution for load testing",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique profile configuration identifier",
      "pattern": "^[a-z0-9-]+$"
    },
    "name": {
      "type": "string",
      "description": "Human-readable name"
    },
    "profiles": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/profile"
      },
      "minItems": 1
    }
  },
  "required": ["id", "profiles"],
  "definitions": {
    "profile": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Profile name identifier"
        },
        "weight": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Percentage weight for this profile (0-100)"
        },
        "journey": {
          "type": "string",
          "description": "Path to journey file for this profile (overrides CLI journey)"
        },
        "dataSource": {
          "type": "string",
          "description": "Path to CSV file with user data"
        },
        "data": {
          "type": "array",
          "items": {
            "type": "object"
          },
          "description": "Inline user data array"
        },
        "variables": {
          "type": "object",
          "description": "Static variables for all users in this profile",
          "additionalProperties": true
        },
        "generators": {
          "type": "object",
          "description": "Dynamic value generators",
          "additionalProperties": {
            "$ref": "#/definitions/generator"
          }
        }
      },
      "required": ["name", "weight"]
    },
    "generator": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["uuid", "timestamp", "random", "sequence", "faker"],
          "description": "Generator type"
        },
        "options": {
          "type": "object",
          "description": "Generator-specific options"
        }
      },
      "required": ["type"]
    }
  }
}
